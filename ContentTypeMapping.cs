using System.Collections.Generic;
using System.Diagnostics.CodeAnalysis;

namespace data_uri_extract
{
    public class ContentTypeMapping
    {
        public IReadOnlyDictionary<string, string> Mappings { get; private set; }

        public ContentTypeMapping()
        {
            Mappings = new Dictionary<string, string>
            {
                { "application/atom+xml", ".atom" },
                { "application/directx", ".x" },
                { "application/envoy", ".evy" },
                { "application/font-woff", ".woff" }, // https://www.w3.org/TR/WOFF/#appendix-b
                { "application/fractals", ".fif" },
                { "application/futuresplash", ".spl" },
                { "application/hta", ".hta" },
                { "application/internet-property-stream", ".acx" },
                { "application/java-archive", ".jar" },
                { "application/javascript", ".js" },
                { "application/json", ".json" },
                //{ "application/liquidmotion", ".jck" },
                { "application/liquidmotion", ".jcz" },
                { "application/mac-binhex40", ".hqx" },
                { "application/manifest+json", ".webmanifest" }, // https://w3c.github.io/manifest/#media-type-registration
                { "application/msaccess", ".accdb" },
                //{ "application/msaccess", ".accde" },
                //{ "application/msaccess", ".accdt" },
                { "application/msword", ".doc" },
                //{ "application/msword", ".dot" },
                { "application/octet-stream", ".bin" },
                { "application/oda", ".oda" },
                { "application/ogg", ".ogx" },
                { "application/oleobject", ".ods" },
                { "application/olescript", ".axs" },
                { "application/onenote", ".one" },
                //{ "application/onenote", ".onea" },
                //{ "application/onenote", ".onepkg" },
                //{ "application/onenote", ".onetmp" },
                //{ "application/onenote", ".onetoc" },
                //{ "application/onenote", ".onetoc2" },
                { "application/opensearchdescription+xml", ".osdx" },
                { "application/pdf", ".pdf" },
                { "application/pics-rules", ".prf" },
                { "application/pkcs10", ".p10" },
                //{ "application/pkcs7-mime", ".p7c" },
                { "application/pkcs7-mime", ".p7m" },
                { "application/pkcs7-signature", ".p7s" },
                { "application/pkix-crl", ".crl" },
                //{ "application/postscript", ".ai" },
                //{ "application/postscript", ".eps" },
                { "application/postscript", ".ps" },
                { "application/rtf", ".rtf" },
                { "application/set-payment-initiation", ".setpay" },
                { "application/set-registration-initiation", ".setreg" },
                { "application/streamingmedia", ".ssm" },
                { "application/vnd.fdf", ".fdf" },
                { "application/vnd.microsoft.portable-executable", ".exe" }, // https://www.iana.org/assignments/media-types/application/vnd.microsoft.portable-executable
                { "application/vnd.ms-cab-compressed", ".cab" },
                //{ "application/vnd.ms-excel", ".xla" },
                //{ "application/vnd.ms-excel", ".xlc" },
                //{ "application/vnd.ms-excel", ".xlm" },
                { "application/vnd.ms-excel", ".xls" },
                //{ "application/vnd.ms-excel", ".xlt" },
                //{ "application/vnd.ms-excel", ".xlw" },
                { "application/vnd.ms-excel.addin.macroenabled.12", ".xlam" },
                { "application/vnd.ms-excel.sheet.binary.macroenabled.12", ".xlsb" },
                { "application/vnd.ms-excel.sheet.macroenabled.12", ".xlsm" },
                { "application/vnd.ms-excel.template.macroenabled.12", ".xltm" },
                { "application/vnd.ms-fontobject", ".eot" },
                { "application/vnd.ms-office.calx", ".calx" },
                { "application/vnd.ms-officetheme", ".thmx" },
                { "application/vnd.ms-pki.certstore", ".sst" },
                { "application/vnd.ms-pki.pko", ".pko" },
                { "application/vnd.ms-pki.seccat", ".cat" },
                { "application/vnd.ms-pki.stl", ".stl" },
                //{ "application/vnd.ms-powerpoint", ".pot" },
                //{ "application/vnd.ms-powerpoint", ".pps" },
                { "application/vnd.ms-powerpoint", ".ppt" },
                { "application/vnd.ms-powerpoint.addin.macroenabled.12", ".ppam" },
                { "application/vnd.ms-powerpoint.presentation.macroenabled.12", ".pptm" },
                { "application/vnd.ms-powerpoint.slide.macroenabled.12", ".sldm" },
                { "application/vnd.ms-powerpoint.slideshow.macroenabled.12", ".ppsm" },
                { "application/vnd.ms-powerpoint.template.macroenabled.12", ".potm" },
                { "application/vnd.ms-project", ".mpp" },
                { "application/vnd.ms-visio.viewer", ".vdx" },
                { "application/vnd.ms-word.document.macroenabled.12", ".docm" },
                { "application/vnd.ms-word.template.macroenabled.12", ".dotm" },
                //{ "application/vnd.ms-works", ".wcm" },
                //{ "application/vnd.ms-works", ".wdb" },
                { "application/vnd.ms-works", ".wks" },
                //{ "application/vnd.ms-works", ".wps" },
                { "application/vnd.ms-xpsdocument", ".xps" },
                { "application/vnd.openxmlformats-officedocument.presentationml.presentation", ".pptx" },
                { "application/vnd.openxmlformats-officedocument.presentationml.slide", ".sldx" },
                { "application/vnd.openxmlformats-officedocument.presentationml.slideshow", ".ppsx" },
                { "application/vnd.openxmlformats-officedocument.presentationml.template", ".potx" },
                { "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", ".xlsx" },
                { "application/vnd.openxmlformats-officedocument.spreadsheetml.template", ".xltx" },
                { "application/vnd.openxmlformats-officedocument.wordprocessingml.document", ".docx" },
                { "application/vnd.openxmlformats-officedocument.wordprocessingml.template", ".dotx" },
                { "application/vnd.rn-realmedia", ".rm" },
                { "application/vnd.visio", ".vsd" },
                //{ "application/vnd.visio", ".vss" },
                //{ "application/vnd.visio", ".vst" },
                //{ "application/vnd.visio", ".vsw" },
                //{ "application/vnd.visio", ".vsx" },
                //{ "application/vnd.visio", ".vtx" },                
                { "application/vnd.wap.wmlc", ".wmlc" },
                { "application/vnd.wap.wmlscriptc", ".wmlsc" },
                { "application/wasm", ".wasm" },
                { "application/winhlp", ".hlp" },
                { "application/x-bcpio", ".bcpio" },
                { "application/x-cdf", ".cdf" },
                { "application/x-compress", ".z" },
                { "application/x-compressed", ".tgz" },
                { "application/x-cpio", ".cpio" },
                { "application/x-csh", ".csh" },
                //{ "application/x-director", ".dcr" },
                { "application/x-director", ".dir" },
                //{ "application/x-director", ".dxr" },
                { "application/x-dvi", ".dvi" },
                //{ "application/x-font-ttf", ".ttc" },
                { "application/x-font-ttf", ".ttf" },
                { "application/x-font-woff", ".woff" },
                { "application/x-gtar", ".gtar" },
                { "application/x-gzip", ".gz" },
                { "application/x-hdf", ".hdf" },
                { "application/x-internet-signup", ".ins" },
                //{ "application/x-internet-signup", ".isp" },
                { "application/x-iphone", ".iii" },
                { "application/x-java-applet", ".class" },
                { "application/x-latex", ".latex" },
                { "application/x-miva-compiled", ".mvc" },
                { "application/x-ms-application", ".application" },
                { "application/x-ms-manifest", ".manifest" },
                { "application/x-ms-reader", ".lit" },
                { "application/x-ms-vsto", ".vsto" },
                { "application/x-ms-wmd", ".wmd" },
                { "application/x-ms-wmz", ".wmz" },
                { "application/x-ms-xbap", ".xbap" },
                { "application/x-msaccess", ".mdb" },
                { "application/x-mscardfile", ".crd" },
                { "application/x-msclip", ".clp" },
                //{ "application/x-msmediaview", ".m13" },
                //{ "application/x-msmediaview", ".m14" },
                { "application/x-msmediaview", ".mvb" },
                { "application/x-msmetafile", ".wmf" },
                { "application/x-msmoney", ".mny" },
                { "application/x-mspublisher", ".pub" },
                { "application/x-msschedule", ".scd" },
                { "application/x-msterminal", ".trm" },
                { "application/x-mswrite", ".wri" },
                { "application/x-netcdf", ".nc" },
                { "application/x-oleobject", ".hhc" },
                //{ "application/x-perfmon", ".pma" },
                //{ "application/x-perfmon", ".pmc" },
                //{ "application/x-perfmon", ".pml" },
                //{ "application/x-perfmon", ".pmr" },
                { "application/x-perfmon", ".pmw" },
                //{ "application/x-pkcs12", ".p12" },
                { "application/x-pkcs12", ".pfx" },
                { "application/x-pkcs7-certificates", ".p7b" },
                //{ "application/x-pkcs7-certificates", ".spc" },
                { "application/x-pkcs7-certreqresp", ".p7r" },
                { "application/x-quicktimeplayer", ".qtl" },
                { "application/x-sh", ".sh" },
                { "application/x-shar", ".shar" },
                { "application/x-shockwave-flash", ".swf" },
                { "application/x-silverlight-app", ".xap" },
                { "application/x-smaf", ".mmf" },
                { "application/x-stuffit", ".sit" },
                { "application/x-sv4cpio", ".sv4cpio" },
                { "application/x-sv4crc", ".sv4crc" },
                { "application/x-tar", ".tar" },
                { "application/x-tcl", ".tcl" },
                { "application/x-tex", ".tex" },
                //{ "application/x-texinfo", ".texi" },
                { "application/x-texinfo", ".texinfo" },
                { "application/x-troff", ".roff" },
                //{ "application/x-troff", ".t" },
                //{ "application/x-troff", ".tr" },
                { "application/x-troff-man", ".man" },
                { "application/x-troff-me", ".me" },
                { "application/x-troff-ms", ".ms" },
                { "application/x-ustar", ".ustar" },
                { "application/x-wais-source", ".src" },
                { "application/x-x509-ca-cert", ".crt" },
                //{ "application/x-x509-ca-cert", ".der" },
                { "application/x-zip-compressed", ".zip" },
                { "application/xaml+xml", ".xaml" },
                //{ "application/xhtml+xml", ".xht" },
                { "application/xhtml+xml", ".xhtml" },
                { "audio/aac", ".aac" },
                //{ "audio/aiff", ".aifc" },
                { "audio/aiff", ".aiff" },
                { "audio/basic", ".au" },
                //{ "audio/basic", ".snd" },
                //{ "audio/mid", ".mid" },
                { "audio/mid", ".midi" },
                //{ "audio/mid", ".rmi" },
                { "audio/mp4", ".m4a" },
                { "audio/mpeg", ".mp3" },
                { "audio/ogg", ".oga" },
                //{ "audio/ogg", ".spx" },
                //{ "audio/vnd.dlna.adts", ".adt" },
                { "audio/vnd.dlna.adts", ".adts" },
                { "audio/wav", ".wav" },
                { "audio/x-aiff", ".aif" },
                { "audio/x-mpegurl", ".m3u" },
                { "audio/x-ms-wax", ".wax" },
                { "audio/x-ms-wma", ".wma" },
                { "audio/x-pn-realaudio", ".ra" },
                //{ "audio/x-pn-realaudio", ".ram" },
                { "audio/x-pn-realaudio-plugin", ".rpm" },
                { "audio/x-smd", ".smd" },
                //{ "audio/x-smd", ".smx" },
                //{ "audio/x-smd", ".smz" },
                { "drawing/x-dwf", ".dwf" },
                { "font/otf", ".otf" },
                { "font/woff2", ".woff2" }, // https://www.w3.org/TR/WOFF2/#IMT
                { "image/bmp", ".bmp" },
                //{ "image/bmp", ".dib" },
                { "image/cis-cod", ".cod" },
                { "image/gif", ".gif" },
                { "image/ief", ".ief" },
                //{ "image/jpeg", ".jpe" },
                //{ "image/jpeg", ".jpeg" },
                { "image/jpeg", ".jpg" },
                { "image/pjpeg", ".jfif" },
                { "image/png", ".png" },
                //{ "image/png", ".pnz" },
                { "image/svg+xml", ".svg" },
                //{ "image/svg+xml", ".svgz" },
                { "image/tiff", ".tif" },
                //{ "image/tiff", ".tiff" },
                { "image/vnd.rn-realflash", ".rf" },
                { "image/vnd.wap.wbmp", ".wbmp" },
                { "image/webp", ".webp" },
                { "image/x-cmu-raster", ".ras" },
                { "image/x-cmx", ".cmx" },
                { "image/x-icon", ".ico" },
                { "image/x-jg", ".art" },
                { "image/x-portable-anymap", ".pnm" },
                { "image/x-portable-bitmap", ".pbm" },
                { "image/x-portable-graymap", ".pgm" },
                { "image/x-portable-pixmap", ".ppm" },
                { "image/x-rgb", ".rgb" },
                { "image/x-xbitmap", ".xbm" },
                { "image/x-xpixmap", ".xpm" },
                { "image/x-xwindowdump", ".xwd" },
                //{ "message/rfc822", ".eml" },
                //{ "message/rfc822", ".mht" },
                { "message/rfc822", ".mhtml" },
                //{ "message/rfc822", ".nws" },
                { "text/cache-manifest", ".appcache" },
                { "text/calendar", ".ical" },
                //{ "text/calendar", ".icalendar" },
                //{ "text/calendar", ".ics" },
                //{ "text/calendar", ".ifb" },
                { "text/css", ".css" },
                { "text/csv", ".csv" }, // https://tools.ietf.org/html/rfc7111#section-5.1
                { "text/dlm", ".dlm" },
                { "text/h323", ".323" },
                //{ "text/html", ".htm" },
                { "text/html", ".html" },
                //{ "text/html", ".hxt" },
                { "text/iuls", ".uls" },
                { "text/jscript", ".jsx" },
                //{ "text/markdown", ".markdown" },
                { "text/markdown", ".md" },
                //{ "text/plain", ".asm" },
                //{ "text/plain", ".bas" },
                //{ "text/plain", ".c" },
                //{ "text/plain", ".cnf" },
                //{ "text/plain", ".cpp" },
                //{ "text/plain", ".h" },
                //{ "text/plain", ".map" },
                { "text/plain", ".txt" },
                //{ "text/plain", ".vcs" },
                //{ "text/plain", ".xdr" },
                { "text/richtext", ".rtx" },
                { "text/scriptlet", ".sct" },
                { "text/sgml", ".sgml" },
                { "text/tab-separated-values", ".tsv" },
                { "text/vbscript", ".vbs" },
                { "text/vnd.wap.wml", ".wml" },
                { "text/vnd.wap.wmlscript", ".wmls" },
                { "text/webviewhtml", ".htt" },
                { "text/x-component", ".htc" },
                { "text/x-hdml", ".hdml" },
                { "text/x-ms-odc", ".odc" },
                { "text/x-setext", ".etx" },
                { "text/x-vcard", ".vcf" },
                //{ "text/xml", ".disco" },
                //{ "text/xml", ".dtd" },
                //{ "text/xml", ".mno" },
                //{ "text/xml", ".vml" },
                //{ "text/xml", ".wsdl" },
                { "text/xml", ".xml" },
                //{ "text/xml", ".xsd" },
                //{ "text/xml", ".xsf" },
                //{ "text/xml", ".xsl" },
                //{ "text/xml", ".xslt" },
                { "video/3gpp", ".3gp" },
                //{ "video/3gpp", ".3gpp" },
                //{ "video/3gpp2", ".3g2" },
                //{ "video/3gpp2", ".3gp2" },
                //{ "video/mp4", ".m4v" },
                { "video/mp4", ".mp4" },
                //{ "video/mp4", ".mp4v" },
                //{ "video/mpeg", ".m1v" },
                //{ "video/mpeg", ".mp2" },
                //{ "video/mpeg", ".mpa" },
                //{ "video/mpeg", ".mpe" },
                //{ "video/mpeg", ".mpeg" },
                { "video/mpeg", ".mpg" },
                //{ "video/mpeg", ".mpv2" },
                //{ "video/ogg", ".ogg" },
                { "video/ogg", ".ogv" },
                { "video/quicktime", ".mov" },
                //{ "video/quicktime", ".qt" },
                //{ "video/vnd.dlna.mpeg-tts", ".m2ts" },
                { "video/vnd.dlna.mpeg-tts", ".ts" },
                //{ "video/vnd.dlna.mpeg-tts", ".tts" },
                { "video/webm", ".webm" },
                { "video/x-flv", ".flv" },
                { "video/x-ivf", ".IVF" },
                //{ "video/x-la-asf", ".lsf" },
                //{ "video/x-la-asf", ".lsx" },
                { "video/x-ms-asf", ".asf" },
                //{ "video/x-ms-asf", ".asr" },
                //{ "video/x-ms-asf", ".asx" },
                //{ "video/x-ms-asf", ".nsc" },
                { "video/x-ms-dvr", ".dvr-ms" },
                { "video/x-ms-wm", ".wm" },
                { "video/x-ms-wmp", ".wmp" },
                { "video/x-ms-wmv", ".wmv" },
                { "video/x-ms-wmx", ".wmx" },
                { "video/x-ms-wtv", ".wtv" },
                { "video/x-ms-wvx", ".wvx" },
                { "video/x-msvideo", ".avi" },
                { "video/x-sgi-movie", ".movie" },
                //{ "x-world/x-vrml", ".flr" },
                { "x-world/x-vrml", ".wrl" },
                //{ "x-world/x-vrml", ".wrz" },
                //{ "x-world/x-vrml", ".xaf" },
                //{ "x-world/x-vrml", ".xof" },
            };
        }

        public bool TryGetExtension(string contentType,  [MaybeNullWhen(false)] out string extension)
        {
            return Mappings.TryGetValue(contentType.ToLowerInvariant(), out extension);
        }
    }
}